<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inbox Messaging System Test</title>
    <style>
        body {
            margin: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f8f9fa;
            padding: 20px;
        }
        
        .demo-container {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        
        .architect-panel, .homeowner-panel {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            height: fit-content;
        }
        
        .architect-panel {
            border-left: 4px solid #1976d2;
        }
        
        .homeowner-panel {
            border-left: 4px solid #4caf50;
        }
        
        .panel-header {
            text-align: center;
            margin-bottom: 25px;
        }
        
        .panel-header h2 {
            margin: 0 0 10px 0;
            font-size: 1.5rem;
        }
        
        .architect-panel h2 {
            color: #1976d2;
        }
        
        .homeowner-panel h2 {
            color: #4caf50;
        }
        
        .panel-header p {
            color: #666;
            margin: 0;
            font-size: 0.9rem;
        }
        
        .save-simulation {
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #1976d2;
            margin-bottom: 20px;
        }
        
        .save-simulation h3 {
            margin: 0 0 15px 0;
            color: #1976d2;
        }
        
        .plan-details {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
            font-size: 0.9rem;
        }
        
        .plan-details h4 {
            margin: 0 0 10px 0;
            color: #1976d2;
        }
        
        .plan-details ul {
            margin: 10px 0 0 0;
            padding-left: 20px;
        }
        
        .plan-details li {
            margin: 5px 0;
        }
        
        .simulate-btn {
            width: 100%;
            padding: 12px 20px;
            background: #1976d2;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.2s;
        }
        
        .simulate-btn:hover {
            background: #1565c0;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(25, 118, 210, 0.3);
        }
        
        .inbox-container {
            margin-top: 20px;
        }
        
        .inbox-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .inbox-header h3 {
            margin: 0;
            color: #4caf50;
        }
        
        .message-count {
            background: #f44336;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .inbox-messages {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
        }
        
        .message-item {
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
            transition: background-color 0.2s;
            cursor: pointer;
        }
        
        .message-item:hover {
            background: #f8f9fa;
        }
        
        .message-item:last-child {
            border-bottom: none;
        }
        
        .message-item.unread {
            background: #e8f5e8;
            border-left: 3px solid #4caf50;
        }
        
        .message-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
        }
        
        .message-title {
            font-weight: 600;
            color: #333;
            font-size: 0.95rem;
            margin: 0;
        }
        
        .message-meta {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 4px;
        }
        
        .message-time {
            font-size: 0.75rem;
            color: #999;
        }
        
        .message-priority {
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .priority-high {
            background: #ffebee;
            color: #c62828;
        }
        
        .priority-normal {
            background: #e3f2fd;
            color: #1976d2;
        }
        
        .message-preview {
            color: #666;
            font-size: 0.85rem;
            line-height: 1.4;
            margin: 0;
        }
        
        .message-sender {
            font-size: 0.8rem;
            color: #1976d2;
            font-weight: 500;
            margin-top: 5px;
        }
        
        .notification-toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border-left: 4px solid #4caf50;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            animation: slideIn 0.3s ease-out;
            max-width: 350px;
        }
        
        .notification-toast.success {
            border-left-color: #4caf50;
            background: linear-gradient(135deg, #f1f8e9 0%, #e8f5e8 100%);
        }
        
        .notification-toast.info {
            border-left-color: #2196f3;
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
        }
        
        .toast-title {
            font-weight: 600;
            color: #333;
            margin: 0 0 5px 0;
            font-size: 0.9rem;
        }
        
        .toast-message {
            color: #666;
            font-size: 0.8rem;
            margin: 0;
            line-height: 1.4;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .empty-inbox {
            text-align: center;
            padding: 40px 20px;
            color: #999;
        }
        
        .empty-inbox-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }
        
        .comparison-section {
            grid-column: 1 / -1;
            margin-top: 30px;
            padding: 25px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            border-left: 4px solid #ff9800;
        }
        
        .comparison-section h3 {
            margin: 0 0 20px 0;
            color: #e65100;
            text-align: center;
        }
        
        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .before, .after {
            padding: 20px;
            border-radius: 8px;
        }
        
        .before {
            background: #ffebee;
            border-left: 3px solid #f44336;
        }
        
        .after {
            background: #f1f8e9;
            border-left: 3px solid #4caf50;
        }
        
        .before h4, .after h4 {
            margin: 0 0 15px 0;
        }
        
        .before h4 {
            color: #c62828;
        }
        
        .after h4 {
            color: #2e7d32;
        }
        
        @media (max-width: 768px) {
            .demo-container {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .comparison-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <div class="architect-panel">
            <div class="panel-header">
                <h2>üë®‚Äçüíº Architect Dashboard</h2>
                <p>Create and save house plans</p>
            </div>
            
            <div class="save-simulation">
                <h3>House Plan Designer</h3>
                <div class="plan-details">
                    <h4>üìã Current Plan: "Modern Family Home"</h4>
                    <ul>
                        <li><strong>Plot Size:</strong> 55' √ó 30' (1,650 sq ft)</li>
                        <li><strong>Rooms:</strong> 5 rooms</li>
                        <li><strong>Construction Area:</strong> 1,320 sq ft</li>
                        <li><strong>Coverage:</strong> 80.0%</li>
                        <li><strong>Notes:</strong> Open floor plan with modern amenities</li>
                    </ul>
                </div>
                <button class="simulate-btn" onclick="simulatePlanSave()">
                    üíæ Save Plan & Send to Homeowner Inbox
                </button>
            </div>
            
            <div style="margin-top: 20px; padding: 15px; background: #e3f2fd; border-radius: 8px;">
                <h4 style="margin: 0 0 10px 0; color: #1976d2;">‚ú® What happens when you save:</h4>
                <ol style="margin: 0; padding-left: 20px; font-size: 0.9rem;">
                    <li>Plan is saved to database</li>
                    <li>Toast notification shows success</li>
                    <li><strong>Inbox message sent to homeowner</strong></li>
                    <li>Homeowner gets notification in their dashboard</li>
                    <li>Message includes all plan details</li>
                </ol>
            </div>
        </div>
        
        <div class="homeowner-panel">
            <div class="panel-header">
                <h2>üè† Homeowner Dashboard</h2>
                <p>Receive updates from your architect</p>
            </div>
            
            <div class="inbox-container">
                <div class="inbox-header">
                    <h3>üì¨ Inbox Messages</h3>
                    <span class="message-count" id="messageCount">0</span>
                </div>
                
                <div class="inbox-messages" id="inboxMessages">
                    <div class="empty-inbox">
                        <div class="empty-inbox-icon">üì≠</div>
                        <p>No messages yet</p>
                        <p style="font-size: 0.8rem; color: #999;">Messages from your architect will appear here</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="comparison-section">
        <h3>üìä Before vs After: Plan Save Notifications</h3>
        <div class="comparison-grid">
            <div class="before">
                <h4>‚ùå Before (Toast Only)</h4>
                <ul>
                    <li>Only architect sees success message</li>
                    <li>Homeowner has no notification</li>
                    <li>No permanent record of the update</li>
                    <li>Homeowner must check dashboard manually</li>
                    <li>No detailed information about changes</li>
                    <li>Easy to miss important updates</li>
                </ul>
            </div>
            <div class="after">
                <h4>‚úÖ After (Toast + Inbox Message)</h4>
                <ul>
                    <li>Architect gets immediate toast confirmation</li>
                    <li><strong>Homeowner receives inbox message</strong></li>
                    <li>Permanent record in homeowner's inbox</li>
                    <li>Detailed plan information included</li>
                    <li>High priority notification</li>
                    <li>Professional communication trail</li>
                    <li>Better client engagement</li>
                    <li>Notification badge in dashboard</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        let messageId = 1;
        let messages = [];
        
        function simulatePlanSave() {
            // Show architect toast notification
            showToast('success', 'Plan Saved Successfully!', 'Your house plan "Modern Family Home" has been saved locally.');
            
            // Simulate sending inbox message to homeowner
            setTimeout(() => {
                showToast('info', 'Message Sent', 'Homeowner has been notified about the plan update in their inbox.');
                
                // Add message to homeowner inbox
                addInboxMessage({
                    id: messageId++,
                    type: 'plan_saved',
                    title: 'New House Plan Created',
                    message: `Your architect has created your house plan "Modern Family Home".

Plan Details:
‚Ä¢ Total Rooms: 5
‚Ä¢ Plot Size: 55' √ó 30' (1,650 sq ft)
‚Ä¢ Construction Area: 1,320 sq ft
‚Ä¢ Coverage: 80.0%

Notes: Open floor plan with modern amenities

You can review and approve this plan from your dashboard.`,
                    sender: 'John Smith (Architect)',
                    priority: 'high',
                    timestamp: new Date(),
                    isRead: false
                });
            }, 1500);
        }
        
        function showToast(type, title, message) {
            const toast = document.createElement('div');
            toast.className = `notification-toast ${type}`;
            toast.innerHTML = `
                <div class="toast-title">${title}</div>
                <div class="toast-message">${message}</div>
            `;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.animation = 'slideOut 0.3s ease-in forwards';
                setTimeout(() => {
                    if (toast.parentNode) {
                        toast.parentNode.removeChild(toast);
                    }
                }, 300);
            }, 4000);
        }
        
        function addInboxMessage(message) {
            messages.unshift(message);
            updateInboxDisplay();
        }
        
        function updateInboxDisplay() {
            const container = document.getElementById('inboxMessages');
            const countElement = document.getElementById('messageCount');
            
            countElement.textContent = messages.length;
            
            if (messages.length === 0) {
                container.innerHTML = `
                    <div class="empty-inbox">
                        <div class="empty-inbox-icon">üì≠</div>
                        <p>No messages yet</p>
                        <p style="font-size: 0.8rem; color: #999;">Messages from your architect will appear here</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = messages.map(message => `
                <div class="message-item ${message.isRead ? '' : 'unread'}" onclick="markAsRead(${message.id})">
                    <div class="message-header">
                        <h4 class="message-title">${message.title}</h4>
                        <div class="message-meta">
                            <span class="message-time">${formatTime(message.timestamp)}</span>
                            <span class="message-priority priority-${message.priority}">${message.priority}</span>
                        </div>
                    </div>
                    <p class="message-preview">${message.message.substring(0, 120)}${message.message.length > 120 ? '...' : ''}</p>
                    <div class="message-sender">From: ${message.sender}</div>
                </div>
            `).join('');
        }
        
        function markAsRead(messageId) {
            const message = messages.find(m => m.id === messageId);
            if (message && !message.isRead) {
                message.isRead = true;
                updateInboxDisplay();
                
                // Show full message in alert (in real app, this would open a modal)
                alert(`${message.title}\n\nFrom: ${message.sender}\n\n${message.message}`);
            }
        }
        
        function formatTime(timestamp) {
            const now = new Date();
            const diff = now - timestamp;
            const minutes = Math.floor(diff / 60000);
            
            if (minutes < 1) return 'Just now';
            if (minutes < 60) return `${minutes}m ago`;
            if (minutes < 1440) return `${Math.floor(minutes / 60)}h ago`;
            return timestamp.toLocaleDateString();
        }
        
        // Add CSS for slideOut animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideOut {
                from {
                    transform: translateX(0);
                    opacity: 1;
                }
                to {
                    transform: translateX(100%);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);
        
        // Add some sample messages for demonstration
        setTimeout(() => {
            addInboxMessage({
                id: messageId++,
                type: 'plan_updated',
                title: 'House Plan Updated',
                message: 'Your architect has made revisions to your house plan based on your feedback. The kitchen layout has been modified and a powder room has been added.',
                sender: 'John Smith (Architect)',
                priority: 'normal',
                timestamp: new Date(Date.now() - 86400000), // 1 day ago
                isRead: true
            });
            
            addInboxMessage({
                id: messageId++,
                type: 'plan_submitted',
                title: 'Plan Ready for Final Review',
                message: 'Your house plan is complete and ready for your final approval. Please review all details and let us know if you have any questions.',
                sender: 'John Smith (Architect)',
                priority: 'high',
                timestamp: new Date(Date.now() - 172800000), // 2 days ago
                isRead: true
            });
        }, 500);
    </script>
</body>
</html>