<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced House Plan Feature - Interactive Demo</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        h1 {
            color: #1976d2;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.2rem;
        }
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .feature-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #1976d2;
            transition: transform 0.2s;
        }
        .feature-card:hover {
            transform: translateY(-2px);
        }
        .feature-card h3 {
            color: #1976d2;
            margin-top: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .feature-card p {
            color: #666;
            line-height: 1.6;
        }
        .demo-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            background: #fafafa;
        }
        .demo-section h2 {
            color: #333;
            margin-top: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .test-button {
            background: linear-gradient(135deg, #1976d2 0%, #1565c0 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-button:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .result {
            margin-top: 15px;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        .success {
            background: #e8f5e8;
            color: #2e7d32;
            border: 1px solid #4caf50;
        }
        .error {
            background: #ffebee;
            color: #c62828;
            border: 1px solid #f44336;
        }
        .enhancement-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        .enhancement-item {
            background: white;
            padding: 15px;
            border-radius: 6px;
            border-left: 3px solid #4caf50;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .enhancement-item h4 {
            margin: 0 0 10px 0;
            color: #2e7d32;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .enhancement-item p {
            margin: 0;
            color: #666;
            font-size: 14px;
        }
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .comparison-table th,
        .comparison-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        .comparison-table th {
            background: #f5f5f5;
            font-weight: 600;
            color: #333;
        }
        .comparison-table tr:hover {
            background: #f9f9f9;
        }
        .old-feature {
            color: #f44336;
        }
        .new-feature {
            color: #4caf50;
            font-weight: 500;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üè† Enhanced House Plan Drawing Feature</h1>
        <p class="subtitle">Interactive, User-Friendly, Construction-Ready</p>
        
        <div class="feature-grid">
            <div class="feature-card">
                <h3>üñ±Ô∏è Drag & Drop Interface</h3>
                <p>Intuitive room placement with real-time visual feedback. Click, drag, and resize rooms with mouse interactions.</p>
            </div>
            <div class="feature-card">
                <h3>üìè Dual Measurement System</h3>
                <p>Separate layout dimensions (visual) and construction dimensions (actual building measurements) with automatic scaling.</p>
            </div>
            <div class="feature-card">
                <h3>üîß Interactive Resize Handles</h3>
                <p>Blue resize handles appear on selected rooms. Drag to resize with real-time dimension updates.</p>
            </div>
            <div class="feature-card">
                <h3>üèóÔ∏è Construction Specifications</h3>
                <p>Add ceiling height, wall thickness, floor type, and wall materials for accurate construction planning.</p>
            </div>
            <div class="feature-card">
                <h3>üìê Smart Grid System</h3>
                <p>Grid-based placement with snap-to-grid functionality and major/minor grid lines for precise positioning.</p>
            </div>
            <div class="feature-card">
                <h3>üé® Enhanced Room Templates</h3>
                <p>14 pre-designed room templates with emoji icons, color coding, and realistic default dimensions.</p>
            </div>
        </div>

        <div class="demo-section">
            <h2>üÜö Before vs After Comparison</h2>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Feature</th>
                        <th>Before (Old Version)</th>
                        <th>After (Enhanced Version)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Room Interaction</strong></td>
                        <td class="old-feature">Click to select only</td>
                        <td class="new-feature">Click, drag to move, resize handles</td>
                    </tr>
                    <tr>
                        <td><strong>Measurements</strong></td>
                        <td class="old-feature">Single dimension system</td>
                        <td class="new-feature">Layout + Construction dimensions</td>
                    </tr>
                    <tr>
                        <td><strong>Room Properties</strong></td>
                        <td class="old-feature">Basic width/height only</td>
                        <td class="new-feature">Construction specs, materials, ceiling height</td>
                    </tr>
                    <tr>
                        <td><strong>Visual Feedback</strong></td>
                        <td class="old-feature">Static room rectangles</td>
                        <td class="new-feature">Gradients, dimension lines, area calculations</td>
                    </tr>
                    <tr>
                        <td><strong>Grid System</strong></td>
                        <td class="old-feature">Basic grid lines</td>
                        <td class="new-feature">Major/minor grids, snap-to-grid</td>
                    </tr>
                    <tr>
                        <td><strong>Room Templates</strong></td>
                        <td class="old-feature">Text-only buttons</td>
                        <td class="new-feature">Emoji icons, tooltips, color-coded</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="demo-section">
            <h2>üöÄ New Interactive Features</h2>
            <div class="enhancement-list">
                <div class="enhancement-item">
                    <h4>üéØ Smart Room Selection</h4>
                    <p>Click any room to select it. Selected rooms show blue borders and resize handles.</p>
                </div>
                <div class="enhancement-item">
                    <h4>üîÑ Drag to Move</h4>
                    <p>Click and drag selected rooms to new positions. Rooms snap to grid and stay within plot boundaries.</p>
                </div>
                <div class="enhancement-item">
                    <h4>üìè Resize Handles</h4>
                    <p>Blue squares on right, bottom, and corner allow precise room resizing with mouse drag.</p>
                </div>
                <div class="enhancement-item">
                    <h4>‚öñÔ∏è Scale Ratio Control</h4>
                    <p>Adjust the ratio between layout dimensions and actual construction dimensions (default 1.2x).</p>
                </div>
                <div class="enhancement-item">
                    <h4>üìä Real-time Calculations</h4>
                    <p>Area calculations update instantly as you resize rooms. Shows both layout and construction areas.</p>
                </div>
                <div class="enhancement-item">
                    <h4>üé® Visual Enhancements</h4>
                    <p>Room gradients, dimension lines, and color-coded measurement text for better visualization.</p>
                </div>
                <div class="enhancement-item">
                    <h4>üèóÔ∏è Construction Details</h4>
                    <p>Add ceiling height, wall thickness, floor materials, and wall types for accurate building specs.</p>
                </div>
                <div class="enhancement-item">
                    <h4>üìê Measurement Modes</h4>
                    <p>Toggle between Layout Only, Construction Only, or Both measurement displays.</p>
                </div>
            </div>
        </div>

        <div class="demo-section">
            <h2>üß™ API Testing</h2>
            <p>Test the enhanced backend APIs with new room data structure:</p>
            
            <button class="test-button" onclick="testEnhancedRoomTemplates()">Test Enhanced Room Templates</button>
            <button class="test-button" onclick="testCreateEnhancedPlan()">Test Create Enhanced Plan</button>
            <button class="test-button" onclick="testConstructionSpecs()">Test Construction Specifications</button>
            
            <div id="api-results"></div>
        </div>

        <div class="demo-section">
            <h2>üìã Usage Instructions</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                <div>
                    <h3>üéØ Selecting Rooms</h3>
                    <ul>
                        <li>Click any room to select it</li>
                        <li>Selected room shows blue border</li>
                        <li>Properties panel updates with room details</li>
                        <li>Click empty space to deselect</li>
                    </ul>
                </div>
                <div>
                    <h3>üîÑ Moving Rooms</h3>
                    <ul>
                        <li>Click and drag selected room</li>
                        <li>Room follows mouse cursor</li>
                        <li>Snaps to grid automatically</li>
                        <li>Stays within plot boundaries</li>
                    </ul>
                </div>
                <div>
                    <h3>üìè Resizing Rooms</h3>
                    <ul>
                        <li>Select room to see blue handles</li>
                        <li>Drag right handle to change width</li>
                        <li>Drag bottom handle to change height</li>
                        <li>Drag corner handle to change both</li>
                    </ul>
                </div>
                <div>
                    <h3>‚öôÔ∏è Setting Properties</h3>
                    <ul>
                        <li>Select room to open properties panel</li>
                        <li>Adjust layout and construction dimensions</li>
                        <li>Set ceiling height and wall thickness</li>
                        <li>Choose floor and wall materials</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="demo-section">
            <h2>üéØ Key Improvements Summary</h2>
            <p>The enhanced house plan feature now provides:</p>
            <ul style="columns: 2; column-gap: 30px;">
                <li>‚úÖ Intuitive drag-and-drop room placement</li>
                <li>‚úÖ Interactive resize handles for precise sizing</li>
                <li>‚úÖ Dual measurement system (layout vs construction)</li>
                <li>‚úÖ Real-time area calculations and statistics</li>
                <li>‚úÖ Construction specifications for building</li>
                <li>‚úÖ Enhanced visual feedback with gradients</li>
                <li>‚úÖ Smart grid system with snap-to-grid</li>
                <li>‚úÖ Emoji-enhanced room templates</li>
                <li>‚úÖ Measurement mode toggles</li>
                <li>‚úÖ Scale ratio control for realistic sizing</li>
                <li>‚úÖ Interactive help and usage instructions</li>
                <li>‚úÖ Professional construction-ready output</li>
            </ul>
        </div>
    </div>

    <script>
        async function testEnhancedRoomTemplates() {
            const resultDiv = document.getElementById('api-results');
            try {
                const response = await fetch('/buildhub/backend/api/architect/get_room_templates.php');
                const result = await response.json();
                
                resultDiv.innerHTML = `<div class="result ${result.success ? 'success' : 'error'}">
Enhanced Room Templates API Test:
${JSON.stringify(result, null, 2)}

Sample Template Structure:
${result.success && result.templates.length > 0 ? 
`- Name: ${result.templates[0].name}
- Category: ${result.templates[0].category}
- Default Size: ${result.templates[0].default_width}' √ó ${result.templates[0].default_height}'
- Color: ${result.templates[0].color}
- Icon: ${result.templates[0].icon}` : 'No templates found'}
</div>`;
            } catch (error) {
                resultDiv.innerHTML = `<div class="result error">
Enhanced Room Templates API Error:
${error.message}
</div>`;
            }
        }

        async function testCreateEnhancedPlan() {
            const resultDiv = document.getElementById('api-results');
            const testData = {
                plan_name: "Enhanced Interactive House Plan",
                plot_width: 45,
                plot_height: 35,
                plan_data: {
                    scale_ratio: 1.2,
                    rooms: [
                        {
                            id: 1,
                            name: "Living Room",
                            category: "living",
                            x: 100,
                            y: 100,
                            layout_width: 16,
                            layout_height: 14,
                            actual_width: 19.2,
                            actual_height: 16.8,
                            color: "#fff3e0",
                            icon: "üõãÔ∏è",
                            ceiling_height: 10,
                            wall_thickness: 0.5,
                            floor_type: "marble",
                            wall_material: "brick"
                        },
                        {
                            id: 2,
                            name: "Master Bedroom",
                            category: "bedroom",
                            x: 200,
                            y: 200,
                            layout_width: 14,
                            layout_height: 12,
                            actual_width: 16.8,
                            actual_height: 14.4,
                            color: "#e8f5e8",
                            icon: "üõèÔ∏è",
                            ceiling_height: 9,
                            wall_thickness: 0.5,
                            floor_type: "wood",
                            wall_material: "brick"
                        }
                    ],
                    total_layout_area: 392,
                    total_construction_area: 564.48
                },
                notes: "Enhanced plan with interactive features, dual measurements, and construction specifications"
            };

            try {
                const response = await fetch('/buildhub/backend/api/architect/create_house_plan.php', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(testData)
                });
                const result = await response.json();
                
                resultDiv.innerHTML = `<div class="result ${result.success ? 'success' : 'error'}">
Create Enhanced Plan API Test:
${JSON.stringify(result, null, 2)}

Plan Features Tested:
‚úÖ Dual measurement system (layout vs construction)
‚úÖ Room construction specifications
‚úÖ Enhanced room properties with materials
‚úÖ Scale ratio for realistic sizing
‚úÖ Emoji icons and color coding
</div>`;
            } catch (error) {
                resultDiv.innerHTML = `<div class="result error">
Create Enhanced Plan API Error:
${error.message}
</div>`;
            }
        }

        async function testConstructionSpecs() {
            const resultDiv = document.getElementById('api-results');
            
            resultDiv.innerHTML = `<div class="result success">
Construction Specifications Test:

New Room Data Structure:
{
  "id": 1,
  "name": "Master Bedroom",
  "category": "bedroom",
  "layout_width": 14,      // Visual layout dimension
  "layout_height": 12,     // Visual layout dimension
  "actual_width": 16.8,    // Construction dimension (14 √ó 1.2)
  "actual_height": 14.4,   // Construction dimension (12 √ó 1.2)
  "ceiling_height": 9,     // Construction specification
  "wall_thickness": 0.5,   // Construction specification
  "floor_type": "ceramic", // Material specification
  "wall_material": "brick" // Material specification
}

Benefits:
‚úÖ Architects can set visual layout for planning
‚úÖ Separate actual dimensions for construction
‚úÖ Material specifications for contractors
‚úÖ Ceiling height for structural planning
‚úÖ Wall thickness for accurate measurements

Scale Ratio Logic:
- Layout: What architect draws (visual representation)
- Construction: Actual building dimensions
- Ratio: 1.2 means construction is 20% larger
- Allows for realistic sizing vs drawing convenience
</div>`;
        }

        // Auto-run enhanced room templates test on page load
        window.onload = function() {
            testEnhancedRoomTemplates();
        };
    </script>
</body>
</html>