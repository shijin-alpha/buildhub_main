<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bank Transfer Payment Test - BuildHub</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .content {
            padding: 30px;
        }

        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            background: #f8f9fa;
        }

        .test-section h3 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .payment-request-card {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .payment-amount {
            font-size: 1.5rem;
            font-weight: 600;
            color: #28a745;
            margin-bottom: 10px;
        }

        .payment-details {
            color: #6c757d;
            margin-bottom: 15px;
        }

        .pay-now-btn {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
        }

        .pay-now-btn:hover {
            background: linear-gradient(135deg, #218838 0%, #1ea085 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(40, 167, 69, 0.4);
        }

        .test-result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 6px;
            font-weight: 500;
        }

        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .method-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .method-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .method-card:hover {
            border-color: #007bff;
            box-shadow: 0 4px 12px rgba(0, 123, 255, 0.15);
        }

        .method-card.recommended {
            border-color: #28a745;
            background: linear-gradient(135deg, #f8fff9 0%, #e8f5e8 100%);
        }

        .method-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .method-name {
            font-weight: 600;
            color: #495057;
            margin-bottom: 5px;
        }

        .method-details {
            font-size: 0.9rem;
            color: #6c757d;
        }

        .bank-details {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }

        .bank-details h4 {
            color: #495057;
            margin-bottom: 15px;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #e9ecef;
        }

        .detail-row:last-child {
            border-bottom: none;
        }

        .detail-label {
            font-weight: 500;
            color: #495057;
        }

        .detail-value {
            font-family: 'Courier New', monospace;
            background: white;
            padding: 4px 8px;
            border-radius: 4px;
            border: 1px solid #dee2e6;
        }

        .copy-btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            margin-left: 8px;
        }

        .instructions {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }

        .instructions h4 {
            color: #495057;
            margin-bottom: 15px;
        }

        .instructions ol {
            padding-left: 20px;
        }

        .instructions li {
            margin-bottom: 8px;
            line-height: 1.5;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üè¶ Bank Transfer Payment Test</h1>
            <p>Testing alternative payment methods including bank transfer functionality</p>
        </div>

        <div class="content">
            <div class="test-section">
                <h3>üìã Test Scenario</h3>
                <p>This test demonstrates the bank transfer payment option for homeowners when making stage payments to contractors. The system should offer multiple payment methods including bank transfer when Razorpay limits are exceeded or when users prefer alternative payment methods.</p>
            </div>

            <div class="test-section">
                <h3>üí∞ Sample Payment Request</h3>
                <div class="payment-request-card">
                    <div class="payment-amount">‚Çπ15,00,000</div>
                    <div class="payment-details">
                        <strong>Project:</strong> Modern Villa Construction<br>
                        <strong>Stage:</strong> Foundation & Structure<br>
                        <strong>Contractor:</strong> ABC Construction Ltd<br>
                        <strong>Status:</strong> Approved - Ready for Payment
                    </div>
                    <button class="pay-now-btn" onclick="testPaymentMethods()">
                        üí≥ Pay Now - Test Payment Methods
                    </button>
                </div>
            </div>

            <div class="test-section">
                <h3>üîß Available Payment Methods</h3>
                <div id="paymentMethods" class="method-grid">
                    <!-- Payment methods will be loaded here -->
                </div>
            </div>

            <div class="test-section" id="bankTransferSection" style="display: none;">
                <h3>üè¶ Bank Transfer Instructions</h3>
                <div class="bank-details">
                    <h4>Bank Details:</h4>
                    <div class="detail-row">
                        <span class="detail-label">Account Name:</span>
                        <div>
                            <span class="detail-value">ABC Construction Ltd</span>
                            <button class="copy-btn" onclick="copyToClipboard('ABC Construction Ltd', 'Account Name')">üìã</button>
                        </div>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Account Number:</span>
                        <div>
                            <span class="detail-value">1234567890123456</span>
                            <button class="copy-btn" onclick="copyToClipboard('1234567890123456', 'Account Number')">üìã</button>
                        </div>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">IFSC Code:</span>
                        <div>
                            <span class="detail-value">SBIN0001234</span>
                            <button class="copy-btn" onclick="copyToClipboard('SBIN0001234', 'IFSC Code')">üìã</button>
                        </div>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Bank Name:</span>
                        <span class="detail-value">State Bank of India</span>
                    </div>
                </div>

                <div class="instructions">
                    <h4>üìã Step-by-Step Instructions:</h4>
                    <ol>
                        <li>Login to your net banking or visit bank branch</li>
                        <li>Select NEFT/RTGS transfer option</li>
                        <li>Enter beneficiary details as shown above</li>
                        <li>Enter amount: ‚Çπ15,00,000</li>
                        <li>Add reference: Payment for Project #12345</li>
                        <li>Complete the transfer and save transaction receipt</li>
                        <li>Upload receipt in the system for verification</li>
                    </ol>
                </div>
            </div>

            <div id="testResults"></div>
        </div>
    </div>

    <script>
        // Test payment methods API
        async function testPaymentMethods() {
            const amount = 1500000; // ‚Çπ15 lakhs
            const resultsDiv = document.getElementById('testResults');
            
            try {
                resultsDiv.innerHTML = '<div class="test-result info">üîÑ Loading payment methods...</div>';
                
                // Test the payment methods API
                const response = await fetch('/buildhub/backend/api/homeowner/get_payment_methods.php', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ amount: amount })
                });

                const data = await response.json();
                
                if (data.success) {
                    displayPaymentMethods(data.data);
                    resultsDiv.innerHTML = '<div class="test-result success">‚úÖ Payment methods loaded successfully!</div>';
                } else {
                    resultsDiv.innerHTML = `<div class="test-result error">‚ùå Failed to load payment methods: ${data.message}</div>`;
                }
            } catch (error) {
                console.error('Payment methods test error:', error);
                resultsDiv.innerHTML = `<div class="test-result error">‚ùå Error testing payment methods: ${error.message}</div>`;
            }
        }

        function displayPaymentMethods(paymentData) {
            const methodsDiv = document.getElementById('paymentMethods');
            const methods = paymentData.available_methods;
            
            let html = '';
            
            Object.entries(methods).forEach(([key, method]) => {
                const isRecommended = key === paymentData.recommended_method;
                const cardClass = isRecommended ? 'method-card recommended' : 'method-card';
                
                html += `
                    <div class="${cardClass}" onclick="selectPaymentMethod('${key}', '${method.name}')">
                        <div class="method-icon">${method.icon}</div>
                        <div class="method-name">${method.name}</div>
                        <div class="method-details">
                            ‚è±Ô∏è ${method.processing_time}<br>
                            üí∞ ${method.fees}
                        </div>
                        ${isRecommended ? '<div style="color: #28a745; font-weight: 600; margin-top: 5px;">‚≠ê Recommended</div>' : ''}
                    </div>
                `;
            });
            
            methodsDiv.innerHTML = html;
        }

        function selectPaymentMethod(methodKey, methodName) {
            const resultsDiv = document.getElementById('testResults');
            
            if (methodKey === 'bank_transfer') {
                document.getElementById('bankTransferSection').style.display = 'block';
                resultsDiv.innerHTML = `<div class="test-result success">‚úÖ Bank Transfer selected! Instructions displayed below.</div>`;
            } else if (methodKey === 'razorpay') {
                resultsDiv.innerHTML = `<div class="test-result info">üí≥ Razorpay payment would be initiated here (limited to ‚Çπ20 lakhs)</div>`;
            } else if (methodKey === 'upi') {
                resultsDiv.innerHTML = `<div class="test-result info">üì± UPI payment would be initiated here (up to ‚Çπ10 lakhs)</div>`;
            } else if (methodKey === 'cheque') {
                resultsDiv.innerHTML = `<div class="test-result info">üìù Cheque payment instructions would be shown here</div>`;
            } else {
                resultsDiv.innerHTML = `<div class="test-result info">‚ÑπÔ∏è ${methodName} payment method selected</div>`;
            }
        }

        function copyToClipboard(text, label) {
            navigator.clipboard.writeText(text).then(() => {
                const resultsDiv = document.getElementById('testResults');
                resultsDiv.innerHTML = `<div class="test-result success">‚úÖ ${label} copied to clipboard!</div>`;
                
                // Clear the message after 3 seconds
                setTimeout(() => {
                    resultsDiv.innerHTML = '';
                }, 3000);
            }).catch(() => {
                const resultsDiv = document.getElementById('testResults');
                resultsDiv.innerHTML = `<div class="test-result error">‚ùå Failed to copy ${label} to clipboard</div>`;
            });
        }

        // Auto-load payment methods on page load
        window.addEventListener('load', () => {
            testPaymentMethods();
        });
    </script>
</body>
</html>